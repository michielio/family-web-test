<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-icons/core-icons.html">
<link rel="import" href="../bower_components/paper-dropdown/paper-dropdown.html">
<link rel="import" href="../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../bower_components/paper-radio-button/paper-radio-button.html">


<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<polymer-element name="Family-members-table">
    <template>
        <style>
            :host {
                position: relative;
            }
            #table_header {
                background-color: #FF5621;
                color: white;
                height: 100%;
                width: 100%;
                font-size: 12px;
            }
            #table {
                background-color: #FFCBBB;
                margin-left: 5%;
                height: 100%;
                width: 90%;
                min-width: 675px;
                border: none;
            }
            .table_column {
                margin-top: 0.5%;
                font-size: 12px;
            }
            .scrollWrapper {
                height: 100%;
                width: 90%;
                overflow: hidden;
            }
            #paperdecoration {
                background-color: white;
                color: black;
                height: 80%;
                margin-top: 0.35%;
            }
            #radio-menu-decoration {
                background-color: white;
                color: black;
                margin-top: 10%;
            }
            #filter-button-position {
                float: left;
                width: 100%;
            }
            #filter {
                display: none;
            }
            p {
                text-align: center;
            }
            @media all and (max-width: 2160px) and (min-width: 800px) {
                :host {
                    position: relative;
                }
                #table_header {
                    background-color: #FF5621;
                    color: white;
                    height: 100%;
                    width: 100%;
                    font-size: 12px;
                }
                #table {
                    background-color: #FFCBBB;
                    margin-left: 5%;
                    height: 100%;
                    width: 90%;
                    min-width: 675px;
                    border: none;
                }
                .table_column {
                    margin-top: 0.5%;
                    font-size: 12px;
                }
                .scrollWrapper {
                    height: 100%;
                    width: 90%;
                    overflow: hidden;
                }
                #paperdecoration {
                    background-color: white;
                    color: black;
                    height: 80%;
                    margin-top: 0.35%;
                }
                #radio-menu-decoration {
                    background-color: white;
                    color: black;
                    margin-top: 10%;
                }
                #filter-button-position {
                    float: left;
                    width: 100%;
                }
                #filter {
                    display: none;
                }
                p {
                    text-align: center;
                }
            }
            @media all and (max-width: 800px) and (min-width: 120px) {
                .scrollWrapper {
                    height: 100%;
                    width: 90%;
                    overflow: scroll;
                }
            }
        </style>

        <div class="scrollWrapper">
            <table id="table" cellspacing="0" cellpadding="0">
                <thead id="table_header">
                    <tr>
                        <th id="first_header_tag"><p>Voornaam</p></th>
                        <th class="table_header_tag"><p>Achternaam</p></th>
                        <th class="table_header_tag"><p>Geb.datum</p></th>
                        <th class="table_header_tag"><p>Straat</p></th>
                        <th class="table_header_tag"><p>Huisnr</p></th>
                        <th class="table_header_tag"><p>Woonplaats</p></th>
                        <th class="table_header_tag"><p>Nationaliteit</p></th>
                        <th class="table_header_tag"><p>Telefoon</p></th>
                        <th class="table_header_tag"><p>Mobiel</p></th>
                        <th class="table_header_tag"><p>E-mail</p></th>
                        <th class="table_header_options"><p> <paper-input id="paperdecoration" type="text" name="search" value="{{searchObject}}"></paper-input> </p></th>
                    </tr>
                </thead>


                <tbody>
                    {{searchObject | filterArray}}
                    <template repeat="{{object in objectData}}">
                        <tr class="table_column">
                            <td id="first_table_content"><p>{{object.forename}}</p></td>
                            <td class="table_contents"><p>{{object.surname}}</p></td>
                            <td class="table_contents"><p>{{object.dateOfBirth}}</p></td>
                            <td class="table_contents"><p>{{object.street}}</p></td>
                            <td class="table_contents"><p>{{object.houseNumber}}</p></td>
                            <td class="table_contents"><p>{{object.city}}</p></td>
                            <td class="table_contents"><p>{{object.nationality}}</p></td>                            
                            <td class="table_contents"><p>{{object.telephoneNumber}}</p></td>
                            <td class="table_contents"><p>{{object.mobilePhoneNumber}}</p></td>
                            <td class="table_contents"><p>{{object.email}}</p></td>
                            <td class="icon_content"><p><core-icon icon="create" onclick="submit({{object.member_id}})" value="" /></p></td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </div>

    </template>

    <script>
        // id van de familie wordt in notificationID neergezet en het formulier wordt verstuurd
        
        Polymer({
            ready: function () {
                console.log("Tabel is bereikt!");
                if (this.attributes.hasOwnProperty("initialData")) {
                    console.log("initialData is ontvangen");
                    this.objectData = JSON.parse(this.attributes['initialData'].value);
                }
            },
            loadData: function (dt) {
                console.log("JSON via Javascript ontvangen")
                this.objectData = dt;
                this.objectDataBackGround = dt;
            },
            toggle: function () {
                console.log("toggle");
                this.$.collapse.toggle();
            },
            sortArray: function () {
                console.log("Sorting Array");
                this.objectDataBackGround = this.objectDataBackGround.sort();
                this.objectData = this.objectDataBackGround;
            },
            filterArray: function () {
                console.log('test');
                var search = "";
                if (this.searchObject !== undefined) {
                    search = this.searchObject;
                }
                console.log("search input :" + this.searchObject);
                console.log("search value :" + search);
                console.log("input array :" + this.objectDataBackGround);
                if (typeof this.objectDataBackGround !== "undefined") {
                    this.objectData = jQuery.grep(this.objectDataBackGround, function (element, index) {
                        var nrBool = (element.requestNumber.toLowerCase()).includes(search.toLowerCase());
                        var fromToSocialworkerBool = (element.fromSocialworker.toLowerCase() + " " + element.toSocialworker.toLowerCase()).includes(search.toLowerCase());
                        if (fromToSocialworkerBool || nrBool) {
                            return true;
                        } else {
                            return false;
                        }
                    })
                    console.log("filter array :" + this.objectData);
                }
            }
        });
    </script>

</polymer-element>