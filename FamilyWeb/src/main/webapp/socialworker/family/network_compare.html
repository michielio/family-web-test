<!DOCTYPE html>
<html>
<head>
<title>Netwerken vergelijken</title>
<meta name="viewport"
	content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-cable" content="yes">
<meta charset="utf-8">
<script
	src="/FamilyWeb/bower_components/webcomponentsjs/webcomponents.min.js"></script>
<link rel="import" href="/FamilyWeb/elements.html">
<link rel="import"
	href="/FamilyWeb/custom_elements/responsive-menu-socialworker.html">
<link rel="import" href="/FamilyWeb/custom_elements/options-menu.html">
<link rel="import"
	href="/FamilyWeb/bower_components/core-media-query/core-media-query.html">
<link rel="import"
	href="/FamilyWeb/bower_components/paper-tabs/paper-tabs.html">
<link rel="stylesheet" href="/FamilyWeb/styles/network_compare.css">
</head>
<body fullbleed layout vertical>
	<core-drawer-panel responsivewidth="1400px"> <core-header-panel
		drawer> <core-toolbar> <core-icon-button
		core-drawer-toggle icon="close"></core-icon-button>
	<div flex>Menu</div>
	</core-toolbar> <responsive-menu-socialworker current="1"></responsive-menu-socialworker>
	</core-header-panel> <core-header-panel main> <core-toolbar
		class="medium-tall"> <core-icon-button
		core-drawer-toggle icon="menu"></core-icon-button>
	<div flex>Netwerken vergelijken</div>
	<options-menu></options-menu>
	<div class="bottom fit" horizontal layout>
		<paper-tabs id="scrollableTabs" selected="1" flex scrollable noink>

		<paper-tab> <a href="/FamilyWeb/socialworker/family/family_members_overview.jsp"
			horizontal center-center layout>Gezinsleden</a></paper-tab> <paper-tab>
		<a href="/FamilyWeb/socialworker/family/network_compare.html" horizontal center-center layout>Netwerken</a></paper-tab>
		<paper-tab> <a href="/FamilyWeb/socialworker/family/new_network_contacts.jsp" horizontal
			center-center layout>Nieuw Netwerk</a></paper-tab> <paper-tab> <a
			href="/FamilyWeb/socialworker/family/share_networks.jsp" horizontal center-center layout>Netwerk(en)
			delen</a></paper-tab> <paper-tab> <a href="/FamilyWeb/socialworker/family/transfer.jsp" horizontal
			center-center layout>Overdragen</a></paper-tab> </paper-tabs>
	</div>
	</core-toolbar>
	<div class="content" fit layout horizontal>
		<div class="content" fit layout horizontal>
			<div class="network_container" id="container1">
				<h1 class="title">Netwerk gemaakt op 21-02-2015</h1>
				<div class="network" id="network1"></div>
				<div class="sidebar">
					<div class="interviewee">
						<h1 class="title">Netwerken van:</h1>
						<select>
							<option value="volvo">Volvo</option>
							<option value="saab">Saab</option>
							<option value="mercedes">Mercedes</option>
							<option value="audi">Audi</option>
						</select>
					</div>
					<div class="contact_groups">
						<p>Contactgroepen</p>
						<ul id="contact_groups1">
							<li>Family<input type="checkbox" value="test"></li>
							<li>Collega's<input type="checkbox" value="test"></li>
							<li>Justitie<input type="checkbox" value="test"></li>
							<li>Religie<input type="checkbox" value="test"></li>
							<li>Family<input type="checkbox" value="test"></li>
							<li>Justitie<input type="checkbox" value="test"></li>
							<li>Religie<input type="checkbox" value="test"></li>
							<li>Family<input type="checkbox" value="test"></li>
						</ul>
					</div>
				</div>
				<div class="timeline">
					<h1 class="title">Tijdlijn met gemaakte netwerken</h1>
					<input class="slider" type="range" name="points" min="0" max="10">
				</div>
				<div class="general_comment">
					<h1 class="title">Algemeen commentaar</h1>
					<p>Lorem Ipsum is slechts een proeftekst uit het drukkerij- en
						zetterijwezen. Lorem Ipsum is de standaard proeftekst in deze
						bedrijfstak sinds de 16e eeuw, toen een onbekende drukker een
						zethaak met letters nam en ze door elkaar husselde om een
						font-catalogus te maken. Het heeft niet alleen vijf eeuwen
						overleefd maar is ook, vrijwel onveranderd, overgenomen in
						elektronische letterzetting</p>
				</div>
			</div>
			<div class="network_container" id="container2">
				<h1 class="title">Netwerk gemaakt op 21-02-2015</h1>
				<div class="network" id="network2"></div>
				<div class="sidebar">
					<div class="interviewee">
						<h1 class="title">Netwerken van:</h1>
						<select>
							<option value="volvo">Volvo</option>
							<option value="saab">Saab</option>
							<option value="mercedes">Mercedes</option>
							<option value="audi">Audi</option>
						</select>
					</div>
					<div class="contact_groups">
						<p>Contactgroepen</p>
						<ul id="contact_groups2">
							<li>Family<input type="checkbox" value="test"></li>
							<li>Collega's<input type="checkbox" value="test"></li>
							<li>Justitie<input type="checkbox" value="test"></li>
							<li>Religie<input type="checkbox" value="test"></li>
							<li>Family<input type="checkbox" value="test"></li>
							<li>Justitie<input type="checkbox" value="test"></li>
							<li>Religie<input type="checkbox" value="test"></li>
							<li>Family<input type="checkbox" value="test"></li>
						</ul>
					</div>
				</div>
				<div class="timeline">
					<h1 class="title">Tijdlijn met gemaakte netwerken</h1>
					<input class="slider" type="range" name="points" min="0" max="10">
				</div>
				<div class="general_comment">
					<h1 class="title">Algemeen commentaar</h1>
					<p>Lorem Ipsum is slechts een proeftekst uit het drukkerij- en
						zetterijwezen. Lorem Ipsum is de standaard proeftekst in deze
						bedrijfstak sinds de 16e eeuw, toen een onbekende drukker een
						zethaak met letters nam en ze door elkaar husselde om een
						font-catalogus te maken. Het heeft niet alleen vijf eeuwen
						overleefd maar is ook, vrijwel onveranderd, overgenomen in
						elektronische letterzetting</p>
				</div>
			</div>
			<div class="resolution_warning_picture"></div>
		</div>
	</core-header-panel> </core-drawer-panel>
	<core-media-query id="mediaQuery" query="max-width: 640px"></core-media-query>

	<script>
		document.querySelector('#mediaQuery').addEventListener(
				'core-media-change',
				function(e) {
					document.body.classList.toggle('core-narrow',
							e.detail.matches);
					document.querySelector('#scrollableTabs').updateBar();
				});
	</script>
	<script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
	<script>
		// Define the dimensions of the visualization. We're using
		// a size that's convenient for displaying the graphic on
		// http://jsDataV.is

		var width = 450, height = 350;

		// nodes is een array waarin elk uniek contact instaat. Er staat een naam bij, bij welke groep het contact hoort (vrienden, Buren etc)

		var nodes = [ {
			"name" : "De Client",
			"group" : 0,
			"x" : 320,
			"y" : 240
		}, {
			"name" : "Harry",
			"group" : 1,
			"x" : 220,
			"y" : 100
		}, {
			"name" : "Hans",
			"group" : 1,
			"x" : 220,
			"y" : 100
		}, {
			"name" : "John",
			"group" : 2,
			"x" : 320,
			"y" : 200
		}, {
			"name" : "Wouter",
			"group" : 2,
			"x" : 320,
			"y" : 200
		}, {
			"name" : "Billy",
			"group" : 2,
			"x" : 320,
			"y" : 200
		}, {
			"name" : "Bert",
			"group" : 3,
			"x" : 320,
			"y" : 200
		}, {
			"name" : "Sjaak",
			"group" : 3,
			"x" : 320,
			"y" : 200
		}, {
			"name" : "Klaas",
			"group" : 3,
			"x" : 320,
			"y" : 200
		} ];

		// Hieronder staan de links dit zijn de verbinden tussen de notes. Elke verbinding heeft een source, van welke node hij vandaan komt. En een 
		// target, Waar hij naar toe gaat. Alle verbinden moeten naar 0 gaan dat is de eerste node die ook meteen de Client is.
		// Verder heb je distance wat de afstand tussen de twee betekend. De strength dat de hoeveelheid contact aangeeft. En het type wat het medium aangeeft 

		var links = [ {
			source : 1,
			target : 0,
			"distance" : 1,
			"strength" : 5,
			"type" : 1,
			"group" : 1
		}, {
			source : 2,
			target : 0,
			"distance" : 2,
			"strength" : 1,
			"type" : 2,
			"group" : 1
		}, {
			source : 3,
			target : 0,
			"distance" : 3,
			"strength" : 3,
			"type" : 3,
			"group" : 2
		}, {
			source : 4,
			target : 0,
			"distance" : 4,
			"strength" : 2,
			"type" : 4,
			"group" : 2
		}, {
			source : 5,
			target : 0,
			"distance" : 5,
			"strength" : 4,
			"type" : 5,
			"group" : 2
		}, {
			source : 6,
			target : 0,
			"distance" : 2,
			"strength" : 2,
			"type" : 4,
			"group" : 3
		}, {
			source : 7,
			target : 0,
			"distance" : 2,
			"strength" : 2,
			"type" : 4,
			"group" : 3
		}, {
			source : 8,
			target : 0,
			"distance" : 2,
			"strength" : 2,
			"type" : 4,
			"group" : 3
		} ];

		//Unieke checkboxes maken
		var unique = {};
		var distinct = [];
		for ( var i in nodes) {
			if (typeof (unique[nodes[i].group]) == "undefined") {
				distinct.push(nodes[i].group);
			}
			unique[nodes[i].group] = 0;
		}
		var ul = document.createElement("ul");

		for (i = 1; i < distinct.length; i++) {
			var checkboxlist = document.createElement("LI")
			var label = document.createElement("label");
			var description = document.createTextNode(distinct[i].valueOf());
			var checkbox = document.createElement("input");

			checkbox.type = "checkbox"; // make the element a checkbox
			checkbox.name = "slct[]"; // give it a name we can check on the server side
			checkbox.value = distinct[i].valueOf(); // make its value "pair"
			checkbox.onclick = function() {
				onChangeCheckbox(this);
			};
			label.appendChild(checkbox); // add the box to the element
			label.appendChild(description);// add the description to the element
			checkboxlist.appendChild(label);
			document.getElementById("contact_groups1")
					.appendChild(checkboxlist);
		}

		var middleX = width / 2;
		var middleY = height / 2;
		var locations = [ {
			x : middleX,
			y : middleY
		} ];

		var diameterCircle = height - 50;
		var r = diameterCircle / 2;

		createLocations();
		function createLocations() {
			for (i = 1; i < distinct.length; i++) {
				var xvalue = width - 100 * i;
				var yvalue = height - 50;
				console.log(xvalue);
				console.log(yvalue);
				locations.push({
					x : xvalue,
					y : yvalue
				});
			}
		}

		var svg = d3.select("#network1").append('svg').attr('width', width)
				.attr('height', height);

		console.dir(locations);
		// Hier wordt de svg container gedefineerd dit is als het ware het canvas om het netwerk op te tekenen.
		// Wij gebruiken het type Force layout. Dit is het type layout waarmee je nodes kan verbinden met elkaar we geven hier de size aan (zelfde als de svg)
		// we geven alle nodes mee
		// we geven alle links mee
		// we geven de charge mee die aangeeft hoeveel afstand elke node van elkaar moeten afhouden
		// we geven de linkDistance mee waarmee we meteen de eerste berekening tegenkomen waar de fysieke afstand tussen contact personen in beeld wordt gebracht
		var force = d3.layout.force().size([ width, height ]).nodes(nodes)
				.links(links).charge(-100).linkDistance(function(links) {
					return links.distance * 50
				}).on('tick', tick).start();

		// Hier worden de linkjes hun eigenschappen meegegeven
		// We geven aan hoe dik ze moeten zijn dmv Strength wat aangeeft hoevaak er contact is. Hoe dikker hoe meer
		// We geven aan welke kleur ze moeten zijn dmv type wat het meest gebruikte medium voorstelt. Elke kleur eigen medium

		var colors = d3.scale.category20();

		var link = svg.selectAll('.link').data(links).enter().append('line')
				.attr('class', 'link').style("stroke-width", function(d) {
					return (d.strength * 2);
				}).style("stroke", function(d) {
					for (i = 0; i < links.length; i++) {
						if (d.group == i) {
							return colors(i);
						}
					}
				});

		/*if (d.type == 1) {
		 return "yellow";
		} else if (d.type == 2){
		 return "gray";
		} else if (d.type == 3){
		 return "red";
		} else if (d.type == 4){
		return "blue";
		} else if (d.type == 5){
		return "green";}
		});
		 */
		// Hier worden de eigenschappen van de nodes meegeven
		// Elke node krijgt een kleur op basis van tot welke groep hij behoort
		// verder worden ze nog in cirkels getekend
		var nodePercentage = 1 / nodes.length;
		var nodeSizeVariable = 50 * nodePercentage;
		var sizeNode = 2 + nodeSizeVariable;

		var node = svg.selectAll('.node').data(nodes).enter().append('g').attr(
				'class', 'node').style("fill", function(d) {
			for (i = 0; i < nodes.length; i++) {
				if (d.group == i) {
					return colors(i);
				}
			}
		}).on("mouseover", mouseover).on("mouseout", mouseout)

		node.append("circle").attr("r", sizeNode);

		node.append("text").attr("x", 18).attr("dy", ".35em").text(function(d) {
			return d.name;
		}).style("fill", "black").style("display", "none");

		// Dit geeft aan of er een animatie in zit of dat eerst alles berekend moet worden voordat het netwerk in beeld komt.
		// When this function executes, the force layout
		// calculations have concluded. The layout will
		// have set various properties in our nodes and
		// links objects that we can use to position them
		// within the SVG container.

		// First let's reposition the nodes. As the force
		// layout runs it updates the `x` and `y` properties
		// that define where the node should be centered.
		// To move the node, we set the appropriate SVG
		// attributes to their new values. We also have to
		// give the node a non-zero radius so that it's visible
		// in the container.

		var groupFill = function(d, i) {
			return colors(i);
		};

		function tick(e) {
			link.attr("x1", function(d) {
				return d.source.x;
			}).attr("y1", function(d) {
				return d.source.y;
			}).attr("x2", function(d) {
				return d.target.x;
			}).attr("y2", function(d) {
				return d.target.y;
			});

			var k = 0.07 * e.alpha;

			// Push nodes toward their designated focus.
			nodes.forEach(function(o, i) {
				o.y += (locations[o.group].y - o.y) * k;
				o.x += (locations[o.group].x - o.x) * k;
			});
			console.dir(locations);
			console.dir(nodes[0])

			node.attr("transform", function(d) {
				return "translate(" + d.x + "," + d.y + ")";
			});
		}
		// Dit stopt de drukke animatie in het begin
		//var k = 0;
		//while ((force.alpha() > 1e-2) && (k < 150)) {
		//   force.tick(),
		//  k = k + 1;
		//}

		// grappige overgang om met je muis aan te wijzen. 
		// de cirkel die je aanwijst wordt een beetje groter en weer kleiner als je met je muis er weer vanaf gaat.

		// Ook wordt hier geprobeerd om de tekst van de node te laten zien zodra je er met je muis boven hangt. Het probleem is alleen dat de naam van de Cliënt alleen getoont wordt bij elke node waarboven je boven hangt.
		// Via d3.select(this).select("item of een div waar je muis boven moet staan.").transition() Kan je een element selecteren en hem vloeiend laten veranderen in iets anders
		// Via d3.select(this).select("item of een div waar je muis boven moet staan.").style() Kan je een element selecteren en de css die daar aanvast zit veranderen.
		function mouseover() {
			d3.select(this).select("circle").transition().duration(300).attr(
					"r", sizeNode * 2)
			d3.select(this).select("text").style("display", "inline");
		}

		function mouseout() {
			d3.select(this).select("circle").transition().duration(300).attr(
					"r", sizeNode)
			d3.select(this).select("text").style("display", "none");
		}

		//Als er een checkbox ingedrukt wordt dan zal deze het statement selectgroup of unselectgroup activeren.
		var selectedNodes = [];
		var selectedLinks = [];
		function onChangeCheckbox(checkbox) {
			d3.selectAll('.node').filter(function(d, i) {
				return (d.group != 0);
			}).transition().style("opacity", 0.2);
			d3.selectAll('.link').transition().style("opacity", 0.2);

			if (checkbox.checked) {
				selectGroupNode(checkbox.value);
				selectGroupLink(checkbox.value);
			} else {
				unselectGroupNode(checkbox.value);
				unselectGroupLink(checkbox.value);
			}

			d3.selectAll('.node').each(function(d) {
				for (i = 0; i < selectedNodes.length; i++) {
					if (d.group == selectedNodes[i]) {
						d3.select(this).transition().style("opacity", 1);
						console.log("selected Node: " + selectedNodes[i]);
					}
				}
			})
			d3.selectAll('.link').each(function(d) {
				for (i = 0; i < selectedLinks.length; i++) {
					if (d.group == selectedLinks[i]) {
						d3.select(this).transition().style("opacity", 1);
						console.log("selected Link: " + selectedLinks[i]);
					}
				}
			})
		}
		//Selectgroup selecteert de groep op basis van een loop door alle nodes heen waarin het groepnummer wat bij het meegegeven is in de checkbox vergeleken met het groepnummer
		//Werkt niet met meerdere geselecteerd.
		function selectGroupNode(groepnummer) {
			selectedNodes.push(groepnummer);
		}

		function selectGroupLink(groepnummer) {
			selectedLinks.push(groepnummer);
		}

		//unselectgroup selecteert de groep op basis van een loop door alle nodes heen waarin het groepnummer wat bij het meegegeven is in de checkbox vergeleken met het groepnummer
		function unselectGroupNode(groepnummer) {
			var index = selectedNodes.indexOf(groepnummer);
			if (index > -1) {
				selectedNodes.splice(index, 1);
			}
			console.log("unselected Node: " + groepnummer);
		}

		function unselectGroupLink(groepnummer) {
			var index = selectedLinks.indexOf(groepnummer);
			if (index > -1) {
				selectedLinks.splice(index, 1);
			}
			console.log("unselected Link: " + groepnummer);
		}
		//var k = d3.select(this).data("group");
		//	d3.selectAll("circle")
		//	.transition()
		//	.style("opacity", function(d) { if (d.group != k) {
		//								 return 0.2;
		//	}
		//	});
	</script>
</body>

</html>
